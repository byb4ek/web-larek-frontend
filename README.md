# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных, используемые в приложении

Продукт

```
export interface IProductItem {
  id: string;
  title: string;
  description: string;
  category: string;
  image: string;
  price: number | null;
}
```

Интерфейс описывает данные частей приложения: каталог, превью, корзина, форма заказа,

```
export interface IAppState {
  catalog: IProductItem[];
  preview: string;
  basket: string[];
  order: IOrder;
  total: string | number;
  loading: boolean;
}
```

Список продуктов

```
export interface IProductsList {
  products: IProductItem[];
}
```

Данные формы заказа

```
export interface IOrderForm {
  payment?: string;
  address?: string;
  phone?: string;
  email?: string;
  total?: string | number;
}
```

Данные покупки

```
export interface IOrder extends IOrderForm {
  items: string[];
}
```

Интерфейс успешного заказа

```
export interface IOrderResult {
  id: string;
}
```

Тип ошибки заказа

```
export type FormErrors = Partial<Record<keyof IOrder, string>>;
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:

- слой представления, отвечает за отображение данных на странице,
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api

Хранит основные поля и методы, необходимые при работе с сервером.\
В конструктор передается базовый url (baseUrl) и опции запроса (options).

Методы:

- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс Model

Абстрактный класс дженерик, обощающий в себе конструктор и метод привязки события.

Конструктор:

- принимает на вход объект данных неявного типа и объект события типа IEvent.
- производит слияние входящего объекта с родительским

Методы:

- emmitChanges — регистрирует входящее событие в EventEmitter

#### Component

Абстрактный класс дженерик, обобщающий в себе конструктор и основные методы работы с компонентами отображения.

Конструктор:
-принимает на вход `container` типа HTMLElement

Методы:

- toggleClass - метод переключения классов
- setText - метод установки текстового содержимого
- setDisabled - метод сменить статус блокировки
- setHidden - метод скрытия
- setVisible - метод показать
- setImage - метод установить изображения с алтернативным текстом
- render - метод возвращения корневого DOM-элемента

#### Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:

- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### Слой данных

#### Класс ProductItem

Принимает и хранит в себе данные об одном продукте: идентифекатор, заголовок, описание, категория, изображение, цену.

Поля класса:

- `id` - идентифекатор продукта
- `title` - название продукта
- `description` - описание продукта
- `category` - категория рассматриваемого продукта
- `image` - изображение описывающее продукт
- `price` - цена продукта

Расширяем базовым классом Model, копируя свойства объекта в текущий экземпляр класса и методом для уведомления об изменениях в модели.
И используем для работы с методами и данными в следующем классе AppDate.

#### Класс AppData

Содержит в себе основные данные и методы для работы с моделью данных в целом. Выступает как собирающий класс.

Поля класса:

- `catalog` - для данных списка товаров
- `preview` - для данных выбранного товара (попап)
- `bascket` - для данных корзины покупок
- `order` - для данных заказа, который отправляется на сервер

Методы:

- `setCatalog` - установить данные в каталог (вывести все наши продукты на страницу)
- `setPreview` - установить данные в первью
- `setProductToBasket` - установить данные в продукты корзины
- `setTotal` - установить финальную сумму заказа
- `setOrderAddress` - установить даныне окна адреса и способа оплаты
- `setOrderContacts` - установить данные окна телефона и почты
- `getTotal` - получить финальную сумму заказа
- `getBasket` - получить данные из корзины
- `getStatusBasket` - получить статус корзины
- `addProductToOrder` - добавить данные карточки в заказ
- `removeProductFromOrder` - убрать один продукт из заказа
- `clearBasket` - очистить данные корзины
- `validationOrderAddress` - провести валидацию данных адреса заказа
- `validationOrderContacts` - провести валидацию данных контактов заказа

#### Класс AppAPI

Основной класс работы с API. Расширяется базовым классом Api.

Конструктор принимает:

- принимает и передает в родительский конструктор `baseUrl` и `options`
- записывает в поле `api` текущий URL

Методы класса:

- `getProductList` - метод запроса списка товаров с сервера
- `orderProducts` - метод отправки данных заказа на сервер

#### Классы представления (View)

Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.

### Page

Класс Page отвечает за отображение всех элементов страницы: корзины, счетчика корзины, каталога товаров.

Поля класса:

- `_counter` - отвечает за счетчик корзины
- `_catalog` - отвечает за хранение разметки каталога карточек
- `_buttonBasket` - отвечает за хранение разметки кнопки корзины
- `_wrapper` - отвечает за хранение обертки страницы

Методы класса:

- `set counter` - отвечает за установку счетчика
- `set catalog` - отвечает за установку каталога

### Card

Класс Card будет отвечать за отображение каждой карточки в отдельности, взятой из каталога.

Поля:

- `_title` - отвечает за храненине названия карточки
- `_category` - хранит разметку категории карточки
- `_image` - хранит разметку изображения карточки
- `_price` - хранит разметку цены карточки
- `_colorCategory` - хранит разметку рамки категории

Конструктор:

- принимает: container:HTMLElement и action:ICardAction
- передает container в родительский конструктор
- записывает данные в необходимые поля
- вешает слушатель клика

Методы:

- `set title` - устанавливает название товара
- `set category` - устанавливает данные категори товара
- `set image` - устанавливает даныне изображение
- `set price` - устанавливает данные цены карточки
- `set colorCategory` - устанавливает данные цвета категории

Класс расширяется интерфейсом, а также в конструкторе используется интерфейс ICardAction

```
inteface ICard {
	title: string;
  category: string;
  image: string;
  price: number;
  text: string;
}
```

```
interface ICardAction{
	onClick(evt:MouseElement) => void;
}
```


### CardPreview

### CardBasket

### Modal

### Form

### Basket

### OrderContacts

### OrderAddress

### Success
